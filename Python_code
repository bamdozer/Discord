#If you want to recreate the code this is how


import plotly.express as px
import pandas as pd

df = pd.read_excel('/Users/bam/Documents/normalized_discord_activity_data_with_chart.xlsx')
# You have to reshpate the dataframe to long format for Plotly
df_long = pd.melt(df, id_vars=['Date'], var_name='Name', value_name='EXP')

# Sorts the dataframe by date/EXP for each Date
df_long = df_long.sort_values(by=['Date', 'EXP'], ascending=[True, True])

# line plot 
fig = go.Figure()

# Add traces for each Name
for name in df_long['Name'].unique():
    df_filtered = df_long[df_long['Name'] == name]
    fig.add_trace(go.Scatter(
        x=df_filtered['Date'], 
        y=df_filtered['EXP'], 
        mode='lines',
        name=name,
        hoverinfo='text',
        hovertext=[
            f"{row['Name']}: {row['EXP']}" for i, row in df_filtered.iterrows()
        ]
    ))

# Make the layout fancy
fig.update_layout(
    title='EXP Progression Over Time',
    xaxis_title='Date',
    yaxis_title='EXP',
    hovermode='x',  # Show all hover data aligned with the x axis
    template='plotly_dark',  # Darker background
    margin=dict(l=40, r=40, t=40, b=40)
)

# Sort the hover data by highest value
fig.update_traces(hovertemplate='<b>%{fullData.name}</b>: %{y}<extra></extra>')

# Save plot as an HTML file
html_file_path = '/Users/bam/Documents/w2exp_progression_over_time.html'
fig.write_html(html_file_path)
